<RadzenButton Icon="csv" Click="OpenFileUpload"
              MouseEnter="@(args => AppTooltipService.ShowTooltip(args, "Upload test Plans data from csv"))"
              MouseLeave="@AppTooltipService.HideTooltip"/>

@code {
    private IEnumerable<TestPlans> _testPlans = [];
    private string _fileContent = string.Empty;
    [EditorRequired] [Parameter] public int ProjectId { get; set; }


    /// <summary>
    /// Event callback to be invoked when the upload is completed. It will refresh the page on parent component.
    /// </summary>
    [Parameter]
    public EventCallback OnUploadCompleted { get; set; }

    private async Task OpenFileUpload()
    {
        var result = await DialogService.OpenAsync($"Import {nameof(TestPlans)} from CSV", ds =>
                @<RadzenStack Orientation="Orientation.Vertical">
                    <RadzenFieldset Text="Expected CSV format" Style="margin-bottom: 15px">
                        <table style="width:100%; border-collapse: collapse; font-size:14px; text-align:left;">
                            <thead style="background-color:#f5f5f5;">
                            <tr>
                                <th style="padding:6px; border:1px solid #ddd;">Name</th>
                                <th style="padding:6px; border:1px solid #ddd;">Description</th>
                                <th style="padding:6px; border:1px solid #ddd;">Priority</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td style="padding:6px; border:1px solid #ddd;">My Test Case</td>
                                <td style="padding:6px; border:1px solid #ddd;">My Description</td>
                                <td style="padding:6px; border:1px solid #ddd;">High</td>
                            </tr>
                            </tbody>
                        </table>

                        <div style="margin-top:10px; font-size:12px; color:gray;">
                            ⚠️ Ensure your CSV file includes these columns in the same order separated by commas.
                            <br/>
                            ⚠️ If Test Case already exists with same Name, it will be skipped.
                        </div>
                    </RadzenFieldset>
                    <RadzenUpload ChooseText="Choose CSV" Accept=".csv" Style="width: 100%" Icon="upload"
                                  Change="@(args => SaveFileContent(args))"/>
                    <RadzenButton Text="Submit" Icon="check" Click="ProcessCsvFile" Style="margin-top: 10px;"/>
                </RadzenStack>
            , new DialogOptions { CloseDialogOnOverlayClick = true, Draggable = true, CloseDialogOnEsc = true });
    }

    int _currentLine = 0;
    int _validLines;
    int _invalidLines;
    int _totalLines;

    private async Task SaveFileContent(UploadChangeEventArgs args)
    {
    }

    private async Task ProcessCsvFile()
    {
    }

}